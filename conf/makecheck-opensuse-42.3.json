{
  "flavor": "b2-30",
  "name": "mkck%02d",
  "image": "makecheck-opensuse-42.3-x86_64",
  "username": "opensuse",
  "userdata": "openstack/user-data.yaml",
  "keyfile": "/home/kyr/.ssh/sa",
  "keyname": "storage-automation",
  "networks": [
    "Ext-Net"
  ],
  "vars": {
    "dependencies": [
      "git",
      "java",
      "htop",
      "ccache"
    ]
  },
  "copy": [
        {
            "into": "bin",
            "from": [
                "snippets/clone-git-repo.sh"
            ],
            "chmod": "0755"
        }
  ],
        "exec": [
                "sudo ulimit -u 10240 2>&1",
                "clone-git-repo.sh ceph https://github.com/suse/ceph ses5 2>&1",
                "cd ceph && ./run-make-check.sh -DWITH_LTTNG=false -DWITH_BABELTRACE=false </dev/null >~/mkck.log 2>&1 & echo $! > ~/mkck.pid",
                "tail -f ~/mkck.log --pid $(cat ~/mkck.pid)"
        ]
}

